"use strict";(globalThis.webpackChunkpicolms_docs=globalThis.webpackChunkpicolms_docs||[]).push([[1234],{4692(e,t,s){s.d(t,{BF:()=>h,cE:()=>u});var i=s(4848),n=s(6540);const a=(0,n.createContext)(null),l=()=>{const e=(0,n.useContext)(a);if(!e)throw new Error("useQuestionContext must be used within a QuestionProvider");return e},o=a.Provider;function r(e){const{config:t,initialAnswer:s,children:a,renderContent:l,onAnswerChange:r,onSubmit:c,onValidationChange:d,showFeedback:u=!1,disabled:m=!1,className:p,"aria-label":h}=e,f=function(e){const{config:t,initialAnswer:s,onAnswerChange:i,autoSave:a=!1,autoSaveDelay:l=1e3}=e,[o,r]=(0,n.useState)({questionId:t.id,value:s,isAnswered:!1,attemptNumber:1,timeSpent:0,timestamp:(new Date).toISOString()}),[c,d]=(0,n.useState)("not-started"),[u,m]=(0,n.useState)(1),[p,h]=(0,n.useState)(0),[f]=(0,n.useState)(Date.now());(0,n.useEffect)(()=>{if("in-progress"===c||"not-started"===c){const e=setInterval(()=>{const e=Math.floor((Date.now()-f)/1e3);h(e)},1e3);return()=>clearInterval(e)}},[c,f]);const b=(0,n.useCallback)(e=>{const s={questionId:t.id,value:e,isAnswered:null!=e&&""!==e,attemptNumber:u,timeSpent:p,timestamp:(new Date).toISOString()};r(s),"not-started"===c&&d("in-progress"),i&&i(s)},[t.id,u,p,c,i]),v=(0,n.useCallback)(()=>{const e={questionId:t.id,value:void 0,isAnswered:!1,attemptNumber:u,timeSpent:p,timestamp:(new Date).toISOString()};r(e),i&&i(e)},[t.id,u,p,i]),x=(0,n.useCallback)(()=>{m(e=>e+1)},[]);return(0,n.useEffect)(()=>{if(a&&o.isAnswered){const e=setTimeout(()=>{console.log("Auto-saving answer:",o)},l);return()=>clearTimeout(e)}},[a,l,o]),{answer:o,setAnswer:b,clearAnswer:v,status:c,setStatus:d,attemptNumber:u,incrementAttempt:x,timeSpent:p,isAnswered:o.isAnswered}}({config:t,initialAnswer:s,onAnswerChange:r}),b="validation"in t?t.validation?.rules:void 0,v=function(e){const{value:t,rules:s=[],validateOnChange:i=!1,onValidationChange:a}=e,[l,o]=(0,n.useState)({isValid:!0,errors:[],warnings:[]}),[r,c]=(0,n.useState)(!1),d=(0,n.useCallback)(async()=>{if(!s||0===s.length)return{isValid:!0,errors:[],warnings:[]};c(!0);const e=[];for(const a of s)try{let s=!0;switch(a.type){case"required":s=null!=t&&""!==t;break;case"minLength":"string"==typeof t&&(s=t.length>=a.value);break;case"maxLength":"string"==typeof t&&(s=t.length<=a.value);break;case"pattern":"string"==typeof t&&a.value&&(s=new RegExp(a.value).test(t));break;case"custom":a.validator&&(s=await a.validator(t))}s||e.push(a.message)}catch(n){e.push(`Validation error: ${n}`)}const i={isValid:0===e.length,errors:e,warnings:[]};return o(i),c(!1),a&&a(i),i},[t,s,a]),u=(0,n.useCallback)(()=>{o({isValid:!0,errors:[],warnings:[]})},[]);return(0,n.useEffect)(()=>{i&&d()},[t,i,d]),{validation:l,validate:d,clearValidation:u,isValidating:r}}({value:f.answer.value,rules:b,validateOnChange:"validation"in t&&t.validation?.validateOnChange,onValidationChange:d}),x=function(e){const{timeLimit:t,onTimeUp:s,onTick:i,autoStart:a=!1}=e,[l,o]=(0,n.useState)(t||0),[r,c]=(0,n.useState)(0),[d,u]=(0,n.useState)(a),[m,p]=(0,n.useState)(!1),h=(0,n.useRef)(null),f=(0,n.useRef)(Date.now()),b=(0,n.useCallback)(()=>{u(!0),f.current=Date.now()},[]),v=(0,n.useCallback)(()=>{u(!1),null!==h.current&&(clearInterval(h.current),h.current=null)},[]),x=(0,n.useCallback)(()=>{u(!0),f.current=Date.now()},[]),g=(0,n.useCallback)(()=>{u(!1),o(t||0),c(0),p(!1),null!==h.current&&(clearInterval(h.current),h.current=null)},[t]);return(0,n.useEffect)(()=>(d&&t&&t>0&&(h.current=window.setInterval(()=>{c(e=>{const n=e+1,a=Math.max(0,t-n);return o(a),i&&i(a),0!==a||m||(p(!0),u(!1),s&&s(),null!==h.current&&(clearInterval(h.current),h.current=null)),n})},1e3)),()=>{null!==h.current&&(clearInterval(h.current),h.current=null)}),[d,t,s,i,m]),{timeRemaining:l,timeElapsed:r,isRunning:d,isTimeUp:m,start:b,pause:v,resume:x,reset:g,progress:t?(t-l)/t*100:0}}({timeLimit:t.timeLimit,onTimeUp:()=>{f.setStatus("submitted"),c&&c(f.answer)},autoStart:!0}),[g,k]=(0,n.useState)(),w=(0,n.useMemo)(()=>m||"submitted"===f.status||"graded"===f.status||void 0!==t.maxAttempts&&f.attemptNumber>t.maxAttempts||x.isTimeUp,[m,f.status,f.attemptNumber,t.maxAttempts,x.isTimeUp]),j=(0,n.useCallback)(async()=>{!(await v.validate()).isValid&&t.feedback?.incorrect&&k(t.feedback.incorrect)},[v,t.feedback]),N=(0,n.useCallback)(()=>{w||j().then(()=>{f.setStatus("submitted"),c&&c(f.answer),u&&v.validation.isValid&&t.feedback?.correct&&k(t.feedback.correct)})},[w,j,f,c,u,v.validation.isValid,t.feedback]),q=(0,n.useMemo)(()=>({config:t,answer:f.answer,setAnswer:f.setAnswer,clearAnswer:f.clearAnswer,status:f.status,setStatus:f.setStatus,attemptNumber:f.attemptNumber,incrementAttempt:f.incrementAttempt,timeSpent:f.timeSpent,isAnswered:f.isAnswered,validation:{isValid:v.validation.isValid,errors:v.validation.errors||[],warnings:v.validation.warnings||[]},validate:j,showFeedback:u,feedback:g,isLocked:w,onSubmit:N,renderContent:l}),[t,f,v.validation,j,u,g,w,N,l]);return(0,i.jsx)(o,{value:q,children:(0,i.jsx)("div",{className:`picolms-base-question ${p||""}`,role:"group","aria-label":h||t.accessibility?.ariaLabel||`Question: ${t.question}`,"aria-describedby":t.accessibility?.ariaDescribedBy,children:a})})}const c=e=>(0,i.jsx)("span",{children:e});function d(){const e=l(),{config:t,answer:s,setAnswer:a,isLocked:o,validation:r,renderContent:d}=e,u=d||c;if("multiple-choice"!==t.type)throw new Error("MultipleChoice component requires a multiple-choice config");const m=(0,n.useMemo)(()=>{if(t.shuffleOptions){const e=t.id.split("").reduce((e,t)=>e+t.charCodeAt(0),0);return function(e,t){const s=[...e],i=t?function(e){return function(){return(e=(9301*e+49297)%233280)/233280}}(t):Math.random;for(let n=s.length-1;n>0;n--){const e=Math.floor(i()*(n+1));[s[n],s[e]]=[s[e],s[n]]}return s}(t.options,e)}return t.options},[t.options,t.shuffleOptions,t.id]),p=Array.isArray(s.value)?s.value:s.value?[s.value]:[],h=(0,n.useCallback)(e=>{if(!o)if(t.allowMultiple){const s=p.includes(e)?p.filter(t=>t!==e):[...p,e];if(t.maxSelections&&s.length>t.maxSelections)return;a(s)}else a(e)},[o,t,p,a]);return(0,i.jsxs)("div",{className:"picolms-multiple-choice-question",children:[(0,i.jsxs)("div",{className:"picolms-question-header",children:[t.title&&(0,i.jsx)("h3",{className:"picolms-question-title",children:t.title}),(0,i.jsx)("div",{className:"picolms-question-text",children:u(t.question,{type:"question",questionId:t.id})}),t.instructions&&(0,i.jsx)("p",{className:"picolms-question-instructions",children:u(t.instructions,{type:"instruction",questionId:t.id})})]}),t.media&&t.media.length>0&&(0,i.jsx)("div",{className:"picolms-question-media",children:t.media.map(e=>(0,i.jsxs)("div",{className:"picolms-media-item",children:["image"===e.type&&(0,i.jsx)("img",{src:e.url,alt:e.alt||""}),e.caption&&(0,i.jsx)("p",{className:"picolms-media-caption",children:e.caption})]},e.id))}),(0,i.jsx)("div",{className:"picolms-mc-options",role:"group","aria-label":"Answer options",children:m.map((s,n)=>(s=>{const n=p.includes(s.id),a=t.allowMultiple?"checkbox":"radio",l=`question-${t.id}`;return(0,i.jsxs)("div",{className:`picolms-mc-option ${n?"mc-option-selected":""} ${o?"mc-option-locked":""}`,children:[(0,i.jsxs)("label",{className:"picolms-mc-option-label",children:[(0,i.jsx)("input",{type:a,name:l,value:s.id,checked:n,onChange:()=>h(s.id),disabled:o,"aria-describedby":s.feedback?`feedback-${s.id}`:void 0}),(0,i.jsx)("span",{className:"picolms-mc-option-text",children:u(s.text,{type:"option",questionId:t.id,optionId:s.id})}),s.media&&(0,i.jsx)("div",{className:"picolms-mc-option-media",children:"image"===s.media.type&&(0,i.jsx)("img",{src:s.media.url,alt:s.media.alt||""})})]}),s.feedback&&n&&e.showFeedback&&(0,i.jsx)("div",{id:`feedback-${s.id}`,className:"picolms-mc-option-feedback",children:u(s.feedback,{type:"feedback",questionId:t.id,optionId:s.id})})]},s.id)})(s))}),r.errors.length>0&&(0,i.jsx)("div",{className:"picolms-question-errors",role:"alert",children:r.errors.map((e,t)=>(0,i.jsx)("p",{className:"picolms-error-message",children:e},t))}),e.feedback&&e.showFeedback&&(0,i.jsx)("div",{className:`picolms-question-feedback feedback-${e.feedback.type}`,role:"status",children:e.feedback.message}),t.feedback?.hints&&t.feedback.hints.length>0&&!o&&(0,i.jsx)("div",{className:"picolms-question-hints",children:(0,i.jsxs)("details",{children:[(0,i.jsx)("summary",{children:"Show Hint"}),t.feedback.hints.map((e,s)=>(0,i.jsx)("p",{className:"picolms-hint-text",children:u(e,{type:"hint",questionId:t.id})},s))]})}),(0,i.jsxs)("div",{className:"picolms-question-meta",children:[(0,i.jsxs)("span",{className:"picolms-question-points",children:[t.points," points"]}),t.difficulty&&(0,i.jsx)("span",{className:"picolms-question-difficulty",children:t.difficulty})]})]})}function u(e){const{config:t,renderContent:s,...n}=e;return(0,i.jsx)(r,{config:t,renderContent:s,...n,children:(0,i.jsx)(d,{})})}const m=e=>(0,i.jsx)("span",{children:e});function p(){const e=l(),{config:t,answer:s,setAnswer:a,isLocked:o,validation:r,renderContent:c}=e,d=c||m;if("true-false"!==t.type)throw new Error("TrueOrFalse component requires a true-false config");const u=(0,n.useCallback)(e=>{o||a(e)},[o,a]),p=t.displayAs||"radio";return(0,i.jsxs)("div",{className:"picolms-true-false-question",children:[(0,i.jsxs)("div",{className:"picolms-question-header",children:[t.title&&(0,i.jsx)("h3",{className:"picolms-question-title",children:t.title}),(0,i.jsx)("div",{className:"picolms-question-text",children:d(t.question,{type:"question",questionId:t.id})}),t.instructions&&(0,i.jsx)("p",{className:"picolms-question-instructions",children:d(t.instructions,{type:"instruction",questionId:t.id})})]}),t.media&&t.media.length>0&&(0,i.jsx)("div",{className:"picolms-question-media",children:t.media.map(e=>(0,i.jsxs)("div",{className:"picolms-media-item",children:["image"===e.type&&(0,i.jsx)("img",{src:e.url,alt:e.alt||""}),e.caption&&(0,i.jsx)("p",{className:"picolms-media-caption",children:e.caption})]},e.id))}),"radio"===p&&(0,i.jsxs)("div",{className:"picolms-tf-options",role:"radiogroup","aria-label":"True or False",children:[(0,i.jsxs)("label",{className:"picolms-tf-option "+(!0===s.value?"tf-option-selected":""),children:[(0,i.jsx)("input",{type:"radio",name:`question-${t.id}`,value:"true",checked:!0===s.value,onChange:()=>u(!0),disabled:o}),(0,i.jsx)("span",{className:"tf-option-text",children:"True"})]}),(0,i.jsxs)("label",{className:"picolms-tf-option "+(!1===s.value?"tf-option-selected":""),children:[(0,i.jsx)("input",{type:"radio",name:`question-${t.id}`,value:"false",checked:!1===s.value,onChange:()=>u(!1),disabled:o}),(0,i.jsx)("span",{className:"tf-option-text",children:"False"})]})]}),"buttons"===p&&(0,i.jsxs)("div",{className:"picolms-tf-buttons",role:"group","aria-label":"True or False",children:[(0,i.jsx)("button",{type:"button",className:"picolms-tf-button "+(!0===s.value?"tf-button-selected":""),onClick:()=>u(!0),disabled:o,"aria-pressed":!0===s.value,children:"True"}),(0,i.jsx)("button",{type:"button",className:"picolms-tf-button "+(!1===s.value?"tf-button-selected":""),onClick:()=>u(!1),disabled:o,"aria-pressed":!1===s.value,children:"False"})]}),"toggle"===p&&(0,i.jsx)("div",{className:"picolms-tf-toggle",children:(0,i.jsxs)("label",{className:"picolms-tf-toggle-label",children:[(0,i.jsx)("input",{type:"checkbox",checked:!0===s.value,onChange:e=>u(e.target.checked),disabled:o,role:"switch","aria-checked":!0===s.value}),(0,i.jsx)("span",{className:"picolms-tf-toggle-slider"}),(0,i.jsx)("span",{className:"picolms-tf-toggle-text",children:!0===s.value?"True":"False"})]})}),r.errors.length>0&&(0,i.jsx)("div",{className:"picolms-question-errors",role:"alert",children:r.errors.map((e,t)=>(0,i.jsx)("p",{className:"picolms-error-message",children:e},t))}),e.feedback&&e.showFeedback&&(0,i.jsx)("div",{className:`picolms-question-feedback feedback-${e.feedback.type}`,role:"status",children:e.feedback.message}),t.feedback?.hints&&t.feedback.hints.length>0&&!o&&(0,i.jsx)("div",{className:"picolms-question-hints",children:(0,i.jsxs)("details",{children:[(0,i.jsx)("summary",{children:"Show Hint"}),t.feedback.hints.map((e,s)=>(0,i.jsx)("p",{className:"picolms-hint-text",children:d(e,{type:"hint",questionId:t.id})},s))]})}),(0,i.jsxs)("div",{className:"picolms-question-meta",children:[(0,i.jsxs)("span",{className:"picolms-question-points",children:[t.points," points"]}),t.difficulty&&(0,i.jsx)("span",{className:"picolms-question-difficulty",children:t.difficulty})]})]})}function h(e){const{config:t,renderContent:s,...n}=e;return(0,i.jsx)(r,{config:t,renderContent:s,...n,children:(0,i.jsx)(p,{})})}const f=(0,n.createContext)(null);f.Provider},8453(e,t,s){s.d(t,{R:()=>l,x:()=>o});var i=s(6540);const n={},a=i.createContext(n);function l(e){const t=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:l(e.components),i.createElement(a.Provider,{value:t},e.children)}},9397(){}}]);